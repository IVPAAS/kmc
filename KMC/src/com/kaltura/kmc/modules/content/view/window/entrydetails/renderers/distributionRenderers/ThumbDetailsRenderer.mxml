<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" horizontalAlign="center" paddingLeft="5" paddingRight="5" borderSides="right" borderStyle="solid">
	<mx:Script>
		<![CDATA[
			import com.kaltura.kmc.modules.content.events.EntryDistributionEvent;
			import com.kaltura.kmc.modules.content.model.ThumbnailWithDimensions;
			import com.kaltura.vo.KalturaEntryDistribution;
			[Bindable]
			private var _dimensionsString:String;
			[Bindable]
			private var _visibleImg:Boolean;
			[Bindable]
			private var _swapVisible:Boolean;
			private var _thumbnail:ThumbnailWithDimensions;
			private var _thumbArray:Array;
			private var _lastIndex:int;
			
			override public function set data(value:Object):void {
				if (!value)
					return;
				if (value is Array) {
					_thumbArray = value as Array;
					_thumbnail = _thumbArray[0] as ThumbnailWithDimensions;
					_lastIndex = 0;
					if (_thumbArray.length > 1)
						_swapVisible = true;
					else
						_swapVisible = false;
				}
				else {
					_thumbnail = value as ThumbnailWithDimensions;
					_swapVisible = false;				
				}
				_dimensionsString = _thumbnail.width + ' X ' + _thumbnail.height;
				if (_thumbnail.thumbUrl) {
					_visibleImg = true;
					img.source = _thumbnail.thumbUrl;
				}
				else {
					_visibleImg = false;
				}
			}
			
			private function onRemoveBtnClick():void {
				parentDocument.removeThumbnail(_thumbnail.thumbAsset.id);
				if (_swapVisible) {
					for (var i:int = 0; i<_thumbArray.length; i++) {
						var thumb:ThumbnailWithDimensions = _thumbArray[i] as ThumbnailWithDimensions;
						thumb.thumbUrl = null;
					}
					_swapVisible = false;
				}
				else
					_thumbnail.thumbUrl = null;
			}
			
			private function onSwapBtnClick():void {
				var oldId:String = _thumbnail.thumbAsset.id;
				_lastIndex++;
				_thumbnail = _thumbArray[_lastIndex % _thumbArray.length];
				parentDocument.swapThumbs(oldId, _thumbnail.thumbAsset.id);
				img.source = _thumbnail.thumbUrl;
			}
			
		]]>
	</mx:Script>
	
	<mx:Label id="dimensionsLabel" text="{_dimensionsString}"/>
	<mx:Image id="img" width="90" height="90" visible="{_visibleImg}"/>
	<mx:Label id="missingLbl" bottom="5" visible="{!_visibleImg}" includeInLayout="{!_visibleImg}" text="{resourceManager.getString('cms','missing')}"/>
	<mx:HBox horizontalAlign="center" width="100%" horizontalGap="0" bottom="5" visible="{_visibleImg}" includeInLayout="{_visibleImg}">
		<mx:LinkButton id="swapBtn" visible="{_swapVisible}" includeInLayout="{_swapVisible}"
					   label="{resourceManager.getString('cms','swap')}" click="{onSwapBtnClick()}"/>
		<mx:LinkButton id="removeBtn" bottom="5" visible="{_visibleImg}" includeInLayout="{_visibleImg}" 
					   label="{resourceManager.getString('cms','remove')}" styleName="multiRemoveButton"
					   click="{onRemoveBtnClick()}"/>
	</mx:HBox>

	
</mx:VBox>
